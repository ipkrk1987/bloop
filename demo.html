<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bloop</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .chat-bubble-user {
      border-radius: 16px 16px 0 16px;
      background-color: #e6f1ff;
    }
    .chat-bubble-bot {
      border-radius: 16px 16px 16px 0;
      background-color: #ffffff;
    }
    .chat-container {
      background-color: #f8f9fa;
    }
  </style>
</head>
<body class="bg-gray-100 text-black font-sans h-screen flex flex-col">
  <header class="bg-blue-600 text-white p-3 flex items-center">
    <div class="flex items-center">
      <div class="w-10 h-10 rounded-full bg-white mr-3 flex items-center justify-center">
        <span class="text-blue-600 font-bold text-lg">B</span>
      </div>
      <div>
        <h1 class="font-medium">Bloop Assistant</h1>
        <p class="text-xs opacity-75">Online</p>
      </div>
    </div>
  </header>

  <div class="chat-container flex-1 p-4 overflow-y-auto flex flex-col space-y-4" id="chatArea">
    <div class="chat-bubble-bot p-3 max-w-[80%] self-start shadow-sm">
      <p>Hi there! I'm Bloop Assistant. Share a thought, and I'll help organize it.</p>
    </div>
  </div>

  <div id="loading" class="hidden px-4 py-2">
    <div class="flex space-x-1 justify-center">
      <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce"></div>
      <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
      <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
    </div>
  </div>

  <div class="bg-white p-3 border-t">
    <div class="flex">
      <input id="thoughtInput" type="text" placeholder="Type a thought..." class="flex-1 rounded-full px-4 py-2 focus:outline-none border border-gray-200" onkeyup="if(event.key === 'Enter') classifyThought()" />
      <button onclick="classifyThought()" class="ml-2 bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
          <path d="M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z" />
        </svg>
      </button>
    </div>
  </div>

  <script>
    let birthdayCluster = [];

    function classifyThought() {
      const input = document.getElementById("thoughtInput").value.trim();
      if (!input) return;

      const chatArea = document.getElementById("chatArea");
      const loading = document.getElementById("loading");

      const userBubble = document.createElement("div");
      userBubble.className = "chat-bubble-user p-3 max-w-[80%] self-end shadow-sm";
      userBubble.innerHTML = `<p>${input}</p>`;
      chatArea.appendChild(userBubble);

      loading.classList.remove("hidden");

      setTimeout(() => {
        loading.classList.add("hidden");

        const isBirthdayCluster = /birthday|cake|invite/i.test(input);
        const isDecision = /should|decide|whether|choice|quit|stay|move/i.test(input);

        const block = document.createElement("div");
        block.className = "chat-bubble-bot p-3 max-w-[80%] self-start shadow-sm bg-white border";
        const tags = ["planning", "event", "shopping"];

        if (isDecision) {
          block.innerHTML = `
            <div class="border-l-4 border-yellow-500 pl-3 mb-2">
              <div class="text-sm text-yellow-700 font-semibold mb-1">[Decision]</div>
              <p class="text-gray-800">${input}</p>
              <div class="text-xs text-gray-500 italic mt-1">You might want to list pros & cons.</div>
            </div>
          `;
        } else {
          block.innerHTML = `
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 shadow-sm mb-4">
              <div class="flex items-center gap-2 mb-2">
                <input type="checkbox" class="accent-blue-500">
                <span class="text-xs font-semibold bg-blue-100 text-blue-800 px-2 py-1 rounded-full">Task</span>
              </div>
              <p class="text-gray-800 text-base mb-2">${input}</p>
              <div class="flex flex-wrap gap-2 text-sm text-gray-600">
                ${tags.map(tag => `<span class="bg-gray-200 px-2 py-1 rounded-full">${tag}</span>`).join('')}
              </div>
            </div>
          `;
        }

        if (isBirthdayCluster && !isDecision) {
          birthdayCluster.push(block);
          if (birthdayCluster.length === 1) {
            const clusterWrapper = document.createElement("div");
            clusterWrapper.id = "birthdayClusterWrapper";
            clusterWrapper.className = "w-full mt-4";
            const header = document.createElement("div");
            header.className = "text-sm text-gray-500 mb-2 font-semibold";
            header.textContent = "ðŸŽ¯ Cluster: Birthday Tasks";
            clusterWrapper.appendChild(header);
            clusterWrapper.appendChild(block);
            chatArea.appendChild(clusterWrapper);
          } else {
            document.getElementById("birthdayClusterWrapper").appendChild(block);
          }
        } else {
          chatArea.appendChild(block);
        }

        document.getElementById("thoughtInput").value = "";
        chatArea.scrollTop = chatArea.scrollHeight;
      }, 1500);
    }
  </script>
</body>
</html>
